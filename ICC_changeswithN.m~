% Is the ICC of edges dependent on sample size?

edges_outputpath='/Volumes/LT_storage/Edges'; % where edges will be saved
ICC_outputpath='/Users/leonardotozzi/Desktop/Repeatability_study/ICCs'; % where ICCs will be saved
atlases={'BNT' 'glasser' 'gordon'};

% making steps of sample sizes, each time taking random rows, permuting
% 1000 times

for atlas=1:length(atlases)
    
    disp(atlases{atlas})
    
    % load edge weigths
    matrix1=csvread(strcat(edges_outputpath, '/', atlases{atlas}, '_edgw1.csv'));
    matrix2=csvread(strcat(edges_outputpath, '/', atlases{atlas}, '_edgw2.csv'));
    
    i=1
    
    for subnum=1:50:size(matrix1, 1)
        [meanicc_allfeat, sdicc_allfeat, meanicc_global, sdicc_global, meansum_excellent, meansum_good, meansum_fair, meansum_poor, sdsum_excellent, sdsum_good, sdsum_fair, sdsum_poor ]=icc_firstNrows(matrix1, matrix2, subnum, 100);
        meansums(i,:)=[meansum_excellent meansum_good meansum_fair meansum_poor];
        sdsums(i,:)=[sdsum_excellent sdsum_good sdsum_fair sdsum_poor];
        allfeat(i,:)=[meanicc_allfeat, sdicc_allfeat];
        globalfeat(i,:)=[meanicc_global, sdicc_global];
        i=i+1;
        
    end
    
    levelnames={'excellent' 'good' 'fair' 'poor'};
    errorbar(meansums,sdsums)
    legend(levelnames)
    title(atlases{atlas})
    xlabel('Sample size')
    ylabel('Mean edges ratio')
    
    csvwrite(strcat(ICC_outputpath, '/ICC_', atlases{atlas}, '_subnum10steplevels1000p_meansums.csv'), meansums);
    csvwrite(strcat(ICC_outputpath, '/ICC_', atlases{atlas}, '_subnum10steplevels1000p_sdsums.csv'), sdsums);
    csvwrite(strcat(ICC_outputpath, 'ICC_', atlases{atlas}, '_subnum10steplevels1000p_allfeat.csv'), allfeat);
    csvwrite(strcat(ICC_outputpath, 'ICC_', atlases{atlas}, '_subnum10steplevels1000p_globalfeat.csv'), globalfeat);
    
end